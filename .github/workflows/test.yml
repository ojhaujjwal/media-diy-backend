name: Automated Tests

on:
  - push

jobs:
  test:
    name: unit-test
    runs-on: ubuntu-latest
    services: 
      minio:
        image: quay.io/minio/minio:RELEASE.2024-05-07T06-41-25Z-cpuv1
        ports:
          - 9000:9000
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version-file: '.nvmrc'
      - name: npm install
        run: npm install
      - name: prettier
        run: npx prettier --check ./src
      - name: lint
        run: npm run lint
      - name: Setup DynamoDB Local
        uses: rrainn/dynamodb-action@v4.0.0
        with:
          delayTransientStatuses: # undefined by default
          optimizeDbBeforeStartup: # undefined by default
          port: 8000
          cors: '*'
      - name: setup dynamo db
        run: bin/setup-dynamo-table
